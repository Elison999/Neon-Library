--[[ 
    NEON GENESIS LIBRARY - V4.0 ULTIMATE
    Build: Stable | Modern UI | Advanced Elements
    By: Elison999
]]

local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local LocalPlayer = game:GetService("Players").LocalPlayer
local Mouse = LocalPlayer:GetMouse()
local CoreGui = game:GetService("CoreGui")

local Library = {
    Connections = {},
    Flags = {},
    UnloadCallback = nil,
    Theme = {
        Main = Color3.fromRGB(25, 25, 30),
        Secondary = Color3.fromRGB(30, 30, 35),
        Stroke = Color3.fromRGB(50, 50, 60),
        Divider = Color3.fromRGB(40, 40, 45),
        Text = Color3.fromRGB(240, 240, 240),
        TextDark = Color3.fromRGB(160, 160, 160),
        Accent = Color3.fromRGB(0, 160, 255),
        Success = Color3.fromRGB(60, 200, 100),
        Error = Color3.fromRGB(220, 60, 60)
    }
}

--// UTILITY FUNCTIONS
local function GetParent()
    return (gethui and gethui()) or CoreGui:FindFirstChild("RobloxGui") or CoreGui
end

local function Tween(obj, info, props)
    local anim = TweenService:Create(obj, TweenInfo.new(info.Time or 0.3, info.Style or Enum.EasingStyle.Quart, info.Dir or Enum.EasingDirection.Out), props)
    anim:Play()
    return anim
end

local function Ripple(obj)
    spawn(function()
        local RippleCircle = Instance.new("ImageLabel")
        RippleCircle.Name = "Ripple"
        RippleCircle.Parent = obj
        RippleCircle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        RippleCircle.BackgroundTransparency = 1.000
        RippleCircle.ZIndex = 10
        RippleCircle.Image = "rbxassetid://266543268"
        RippleCircle.ImageColor3 = Color3.fromRGB(255, 255, 255)
        RippleCircle.ImageTransparency = 0.800
        RippleCircle.ScaleType = Enum.ScaleType.Fit
        
        local NewX, NewY = Mouse.X - RippleCircle.AbsolutePosition.X, Mouse.Y - RippleCircle.AbsolutePosition.Y
        RippleCircle.Position = UDim2.new(0, NewX, 0, NewY)
        
        local Size = 0
        if obj.AbsoluteSize.X > obj.AbsoluteSize.Y then
             Size = obj.AbsoluteSize.X * 1.5
        elseif obj.AbsoluteSize.X < obj.AbsoluteSize.Y then
             Size = obj.AbsoluteSize.Y * 1.5
        elseif obj.AbsoluteSize.X == obj.AbsoluteSize.Y then
             Size = obj.AbsoluteSize.X * 1.5
        end
        
        RippleCircle:TweenSizeAndPosition(UDim2.new(0, Size, 0, Size), UDim2.new(0.5, -Size/2, 0.5, -Size/2), "Out", "Quad", 0.5, false)
        Tween(RippleCircle, {Time = 0.5}, {ImageTransparency = 1})
        
        task.wait(0.5)
        RippleCircle:Destroy()
    end)
end

local function MakeDraggable(topbar, object)
    local dragging, dragInput, dragStart, startPos

    topbar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = object.Position

            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then dragging = false end
            end)
        end
    end)

    topbar.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            Tween(object, {Time = 0.05}, {Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)})
        end
    end)
end

--// NOTIFICATION SYSTEM
local NotificationGUI = Instance.new("ScreenGui")
NotificationGUI.Name = "NeonNotifications"
NotificationGUI.Parent = GetParent()
NotificationGUI.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

local NotifyContainer = Instance.new("Frame")
NotifyContainer.Name = "Container"
NotifyContainer.Parent = NotificationGUI
NotifyContainer.AnchorPoint = Vector2.new(1, 1)
NotifyContainer.Position = UDim2.new(1, -20, 1, -20)
NotifyContainer.Size = UDim2.new(0, 300, 1, 0)
NotifyContainer.BackgroundTransparency = 1

local NotifyLayout = Instance.new("UIListLayout")
NotifyLayout.Parent = NotifyContainer
NotifyLayout.HorizontalAlignment = Enum.HorizontalAlignment.Right
NotifyLayout.VerticalAlignment = Enum.VerticalAlignment.Bottom
NotifyLayout.SortOrder = Enum.SortOrder.LayoutOrder
NotifyLayout.Padding = UDim.new(0, 8)

function Library:Notification(title, content, duration)
    local NotifyFrame = Instance.new("Frame")
    NotifyFrame.Name = "Notify"
    NotifyFrame.Parent = NotifyContainer
    NotifyFrame.BackgroundColor3 = Library.Theme.Secondary
    NotifyFrame.Size = UDim2.new(1, 0, 0, 0) -- Starts small
    NotifyFrame.ClipsDescendants = true
    
    local Stroke = Instance.new("UIStroke")
    Stroke.Parent = NotifyFrame
    Stroke.Color = Library.Theme.Stroke
    Stroke.Thickness = 1
    
    local Corner = Instance.new("UICorner")
    Corner.CornerRadius = UDim.new(0, 6)
    Corner.Parent = NotifyFrame
    
    local Bar = Instance.new("Frame")
    Bar.Name = "Bar"
    Bar.Parent = NotifyFrame
    Bar.BackgroundColor3 = Library.Theme.Accent
    Bar.Position = UDim2.new(0, 0, 1, -2)
    Bar.Size = UDim2.new(1, 0, 0, 2)
    Bar.BorderSizePixel = 0
    
    local TitleLabel = Instance.new("TextLabel")
    TitleLabel.Parent = NotifyFrame
    TitleLabel.BackgroundTransparency = 1
    TitleLabel.Position = UDim2.new(0, 12, 0, 8)
    TitleLabel.Size = UDim2.new(1, -24, 0, 20)
    TitleLabel.Font = Enum.Font.GothamBold
    TitleLabel.Text = title
    TitleLabel.TextColor3 = Library.Theme.Text
    TitleLabel.TextSize = 14
    TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
    
    local ContentLabel = Instance.new("TextLabel")
    ContentLabel.Parent = NotifyFrame
    ContentLabel.BackgroundTransparency = 1
    ContentLabel.Position = UDim2.new(0, 12, 0, 28)
    ContentLabel.Size = UDim2.new(1, -24, 0, 30)
    ContentLabel.Font = Enum.Font.Gotham
    ContentLabel.Text = content
    ContentLabel.TextColor3 = Library.Theme.TextDark
    ContentLabel.TextSize = 12
    ContentLabel.TextXAlignment = Enum.TextXAlignment.Left
    ContentLabel.TextWrapped = true

    -- Animation In
    Tween(NotifyFrame, {Time = 0.5}, {Size = UDim2.new(1, 0, 0, 70)})
    Tween(Bar, {Time = duration or 3, Style = Enum.EasingStyle.Linear}, {Size = UDim2.new(0, 0, 0, 2)})
    
    task.delay(duration or 3, function()
        local Out = Tween(NotifyFrame, {Time = 0.5}, {Size = UDim2.new(1, 0, 0, 0), BackgroundTransparency = 1})
        Tween(TitleLabel, {Time=0.3}, {TextTransparency=1})
        Tween(ContentLabel, {Time=0.3}, {TextTransparency=1})
        Out.Completed:Connect(function()
            NotifyFrame:Destroy()
        end)
    end)
end

--// MAIN WINDOW
function Library:Window(Config)
    Config = Config or {}
    Config.Title = Config.Title or "Neon Genesis"
    Config.Theme = Config.Theme or "Default"
    
    -- Cleanup Old
    for _, v in pairs(GetParent():GetChildren()) do
        if v.Name == "NeonGenesisUI" then v:Destroy() end
    end

    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "NeonGenesisUI"
    ScreenGui.Parent = GetParent()
    ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

    local MainFrame = Instance.new("Frame")
    MainFrame.Name = "MainFrame"
    MainFrame.Parent = ScreenGui
    MainFrame.BackgroundColor3 = Library.Theme.Main
    MainFrame.Position = UDim2.new(0.5, -300, 0.5, -200)
    MainFrame.Size = UDim2.new(0, 600, 0, 400)
    MainFrame.ClipsDescendants = true
    
    local MainStroke = Instance.new("UIStroke")
    MainStroke.Parent = MainFrame
    MainStroke.Color = Library.Theme.Accent
    MainStroke.Thickness = 1
    MainStroke.Transparency = 0.5

    local MainCorner = Instance.new("UICorner")
    MainCorner.CornerRadius = UDim.new(0, 8)
    MainCorner.Parent = MainFrame

    -- Shadow
    local Shadow = Instance.new("ImageLabel")
    Shadow.Name = "Shadow"
    Shadow.Parent = MainFrame
    Shadow.AnchorPoint = Vector2.new(0.5, 0.5)
    Shadow.BackgroundTransparency = 1.000
    Shadow.Position = UDim2.new(0.5, 0, 0.5, 0)
    Shadow.Size = UDim2.new(1, 140, 1, 140)
    Shadow.ZIndex = -1
    Shadow.Image = "rbxassetid://6015897843"
    Shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
    Shadow.ImageTransparency = 0.400
    Shadow.ScaleType = Enum.ScaleType.Slice
    Shadow.SliceCenter = Rect.new(49, 49, 450, 450)

    -- Sidebar
    local Sidebar = Instance.new("Frame")
    Sidebar.Name = "Sidebar"
    Sidebar.Parent = MainFrame
    Sidebar.BackgroundColor3 = Library.Theme.Secondary
    Sidebar.Size = UDim2.new(0, 160, 1, 0)
    Sidebar.BorderSizePixel = 0
    
    local SidebarCorner = Instance.new("UICorner")
    SidebarCorner.CornerRadius = UDim.new(0, 8)
    SidebarCorner.Parent = Sidebar
    
    local SidebarFix = Instance.new("Frame") -- Square off the right side
    SidebarFix.Parent = Sidebar
    SidebarFix.BackgroundColor3 = Library.Theme.Secondary
    SidebarFix.BorderSizePixel = 0
    SidebarFix.Position = UDim2.new(1, -5, 0, 0)
    SidebarFix.Size = UDim2.new(0, 5, 1, 0)

    local TitleLabel = Instance.new("TextLabel")
    TitleLabel.Parent = Sidebar
    TitleLabel.BackgroundTransparency = 1
    TitleLabel.Position = UDim2.new(0, 15, 0, 20)
    TitleLabel.Size = UDim2.new(1, -20, 0, 30)
    TitleLabel.Font = Enum.Font.GothamBold
    TitleLabel.Text = Config.Title
    TitleLabel.TextColor3 = Library.Theme.Accent
    TitleLabel.TextSize = 18
    TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
    
    local TabContainer = Instance.new("ScrollingFrame")
    TabContainer.Name = "TabContainer"
    TabContainer.Parent = Sidebar
    TabContainer.Active = true
    TabContainer.BackgroundTransparency = 1
    TabContainer.BorderSizePixel = 0
    TabContainer.Position = UDim2.new(0, 0, 0, 70)
    TabContainer.Size = UDim2.new(1, 0, 1, -80)
    TabContainer.ScrollBarThickness = 2
    TabContainer.ScrollBarImageColor3 = Library.Theme.Accent
    
    local TabLayout = Instance.new("UIListLayout")
    TabLayout.Parent = TabContainer
    TabLayout.SortOrder = Enum.SortOrder.LayoutOrder
    TabLayout.Padding = UDim.new(0, 6)
    
    local TabPadding = Instance.new("UIPadding")
    TabPadding.Parent = TabContainer
    TabPadding.PaddingLeft = UDim.new(0, 10)
    TabPadding.PaddingTop = UDim.new(0, 10)

    -- Pages Area
    local PageContainer = Instance.new("Frame")
    PageContainer.Name = "PageContainer"
    PageContainer.Parent = MainFrame
    PageContainer.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    PageContainer.BackgroundTransparency = 1.000
    PageContainer.Position = UDim2.new(0, 170, 0, 10)
    PageContainer.Size = UDim2.new(1, -180, 1, -20)
    
    MakeDraggable(Sidebar, MainFrame) -- Sidebar acts as drag handle

    local WindowFunctions = {}
    local FirstTab = true

    function WindowFunctions:Tab(name, icon)
        local TabButton = Instance.new("TextButton")
        TabButton.Name = name .. "Tab"
        TabButton.Parent = TabContainer
        TabButton.BackgroundColor3 = Library.Theme.Main
        TabButton.BackgroundTransparency = 1 -- Start transparent
        TabButton.Size = UDim2.new(0, 140, 0, 34)
        TabButton.Font = Enum.Font.GothamSemibold
        TabButton.Text = "  " .. name
        TabButton.TextColor3 = Library.Theme.TextDark
        TabButton.TextSize = 13
        TabButton.TextXAlignment = Enum.TextXAlignment.Left
        TabButton.AutoButtonColor = false
        
        local TabCorner = Instance.new("UICorner")
        TabCorner.CornerRadius = UDim.new(0, 6)
        TabCorner.Parent = TabButton
        
        local Indicator = Instance.new("Frame")
        Indicator.Parent = TabButton
        Indicator.BackgroundColor3 = Library.Theme.Accent
        Indicator.Position = UDim2.new(0, 0, 0.2, 0)
        Indicator.Size = UDim2.new(0, 3, 0.6, 0)
        Indicator.BackgroundTransparency = 1
        Instance.new("UICorner", Indicator).CornerRadius = UDim.new(1,0)

        local Page = Instance.new("ScrollingFrame")
        Page.Name = name .. "Page"
        Page.Parent = PageContainer
        Page.Active = true
        Page.BackgroundTransparency = 1
        Page.BorderSizePixel = 0
        Page.Size = UDim2.new(1, 0, 1, 0)
        Page.ScrollBarThickness = 3
        Page.ScrollBarImageColor3 = Library.Theme.Stroke
        Page.Visible = false
        
        local PageLayout = Instance.new("UIListLayout")
        PageLayout.Parent = Page
        PageLayout.SortOrder = Enum.SortOrder.LayoutOrder
        PageLayout.Padding = UDim.new(0, 10)
        
        local PagePad = Instance.new("UIPadding")
        PagePad.Parent = Page
        PagePad.PaddingRight = UDim.new(0, 10)
        PagePad.PaddingTop = UDim.new(0, 5)

        -- Update Canvas Size automatically
        PageLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            Page.CanvasSize = UDim2.new(0, 0, 0, PageLayout.AbsoluteContentSize.Y + 20)
        end)

        local function Activate()
            -- Reset others
            for _, t in pairs(TabContainer:GetChildren()) do
                if t:IsA("TextButton") then
                    Tween(t, {Time=0.3}, {BackgroundTransparency = 1, TextColor3 = Library.Theme.TextDark})
                    Tween(t:FindFirstChild("Frame"), {Time=0.3}, {BackgroundTransparency = 1})
                end
            end
            for _, p in pairs(PageContainer:GetChildren()) do p.Visible = false end
            
            -- Activate this
            Tween(TabButton, {Time=0.3}, {BackgroundTransparency = 0, BackgroundColor3 = Library.Theme.Secondary, TextColor3 = Library.Theme.Text})
            Tween(Indicator, {Time=0.3}, {BackgroundTransparency = 0})
            Page.Visible = true
        end
        
        TabButton.MouseButton1Click:Connect(Activate)
        
        if FirstTab then
            FirstTab = false
            Activate()
        end

        local TabFunctions = {}

        --// ELEMENT: SECTION
        function TabFunctions:Section(text)
            local SectionFrame = Instance.new("Frame")
            SectionFrame.Name = "Section"
            SectionFrame.Parent = Page
            SectionFrame.BackgroundTransparency = 1
            SectionFrame.Size = UDim2.new(1, 0, 0, 30)
            
            local Label = Instance.new("TextLabel")
            Label.Parent = SectionFrame
            Label.BackgroundTransparency = 1
            Label.Position = UDim2.new(0, 2, 0, 10)
            Label.Size = UDim2.new(1, 0, 0, 20)
            Label.Font = Enum.Font.GothamBold
            Label.Text = text
            Label.TextColor3 = Library.Theme.TextDark
            Label.TextSize = 11
            Label.TextXAlignment = Enum.TextXAlignment.Left
            Label.TextTransparency = 0.2
            
            local Line = Instance.new("Frame")
            Line.Parent = SectionFrame
            Line.BackgroundColor3 = Library.Theme.Divider
            Line.BorderSizePixel = 0
            Line.Position = UDim2.new(0, Label.TextBounds.X + 10, 0.5, 5)
            Line.Size = UDim2.new(1, -(Label.TextBounds.X + 15), 0, 1)
        end

        --// ELEMENT: BUTTON
        function TabFunctions:Button(text, callback, tooltip)
            callback = callback or function() end
            local Button = Instance.new("TextButton")
            Button.Name = "Button"
            Button.Parent = Page
            Button.BackgroundColor3 = Library.Theme.Secondary
            Button.Size = UDim2.new(1, 0, 0, 38)
            Button.AutoButtonColor = false
            Button.Font = Enum.Font.GothamSemibold
            Button.Text = text
            Button.TextColor3 = Library.Theme.Text
            Button.TextSize = 13
            
            local BtnCorner = Instance.new("UICorner")
            BtnCorner.CornerRadius = UDim.new(0, 6)
            BtnCorner.Parent = Button
            
            local BtnStroke = Instance.new("UIStroke")
            BtnStroke.Parent = Button
            BtnStroke.Color = Library.Theme.Stroke
            BtnStroke.Thickness = 1
            BtnStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
            
            Button.MouseButton1Click:Connect(function()
                Ripple(Button)
                Tween(Button, {Time=0.1}, {BackgroundColor3 = Library.Theme.Divider})
                task.wait(0.1)
                Tween(Button, {Time=0.3}, {BackgroundColor3 = Library.Theme.Secondary})
                task.spawn(callback)
            end)
            
            Button.MouseEnter:Connect(function() 
                Tween(BtnStroke, {Time=0.2}, {Color = Library.Theme.Accent}) 
            end)
            Button.MouseLeave:Connect(function() 
                Tween(BtnStroke, {Time=0.2}, {Color = Library.Theme.Stroke}) 
            end)
        end

        --// ELEMENT: TOGGLE
        function TabFunctions:Toggle(text, default, callback)
            local toggled = default or false
            local ToggleFrame = Instance.new("TextButton")
            ToggleFrame.Name = "Toggle"
            ToggleFrame.Parent = Page
            ToggleFrame.BackgroundColor3 = Library.Theme.Secondary
            ToggleFrame.Size = UDim2.new(1, 0, 0, 38)
            ToggleFrame.AutoButtonColor = false
            ToggleFrame.Text = ""
            
            local TogCorner = Instance.new("UICorner")
            TogCorner.CornerRadius = UDim.new(0, 6)
            TogCorner.Parent = ToggleFrame
            
            local TogStroke = Instance.new("UIStroke")
            TogStroke.Parent = ToggleFrame
            TogStroke.Color = Library.Theme.Stroke
            TogStroke.Thickness = 1
            
            local Label = Instance.new("TextLabel")
            Label.Parent = ToggleFrame
            Label.BackgroundTransparency = 1
            Label.Position = UDim2.new(0, 12, 0, 0)
            Label.Size = UDim2.new(1, -60, 1, 0)
            Label.Font = Enum.Font.GothamSemibold
            Label.Text = text
            Label.TextColor3 = Library.Theme.Text
            Label.TextSize = 13
            Label.TextXAlignment = Enum.TextXAlignment.Left
            
            local SwitchBg = Instance.new("Frame")
            SwitchBg.Parent = ToggleFrame
            SwitchBg.BackgroundColor3 = toggled and Library.Theme.Accent or Library.Theme.Main
            SwitchBg.Position = UDim2.new(1, -50, 0.5, -10)
            SwitchBg.Size = UDim2.new(0, 38, 0, 20)
            
            local SwitchCorner = Instance.new("UICorner")
            SwitchCorner.CornerRadius = UDim.new(1, 0)
            SwitchCorner.Parent = SwitchBg
            
            local SwitchDot = Instance.new("Frame")
            SwitchDot.Parent = SwitchBg
            SwitchDot.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
            SwitchDot.Position = toggled and UDim2.new(1, -18, 0.5, -8) or UDim2.new(0, 2, 0.5, -8)
            SwitchDot.Size = UDim2.new(0, 16, 0, 16)
            
            local DotCorner = Instance.new("UICorner")
            DotCorner.CornerRadius = UDim.new(1, 0)
            DotCorner.Parent = SwitchDot
            
            local function Update()
                toggled = not toggled
                local targetColor = toggled and Library.Theme.Accent or Library.Theme.Main
                local targetPos = toggled and UDim2.new(1, -18, 0.5, -8) or UDim2.new(0, 2, 0.5, -8)
                
                Tween(SwitchBg, {Time=0.2}, {BackgroundColor3 = targetColor})
                Tween(SwitchDot, {Time=0.2}, {Position = targetPos})
                callback(toggled)
            end
            
            ToggleFrame.MouseButton1Click:Connect(Update)
        end

        --// ELEMENT: SLIDER
        function TabFunctions:Slider(text, min, max, default, callback)
            local SliderFrame = Instance.new("Frame")
            SliderFrame.Name = "Slider"
            SliderFrame.Parent = Page
            SliderFrame.BackgroundColor3 = Library.Theme.Secondary
            SliderFrame.Size = UDim2.new(1, 0, 0, 50)
            
            local SliCorner = Instance.new("UICorner")
            SliCorner.CornerRadius = UDim.new(0, 6)
            SliCorner.Parent = SliderFrame
            
            local SliStroke = Instance.new("UIStroke")
            SliStroke.Parent = SliderFrame
            SliStroke.Color = Library.Theme.Stroke
            SliStroke.Thickness = 1
            
            local Label = Instance.new("TextLabel")
            Label.Parent = SliderFrame
            Label.BackgroundTransparency = 1
            Label.Position = UDim2.new(0, 12, 0, 8)
            Label.Size = UDim2.new(1, -24, 0, 20)
            Label.Font = Enum.Font.GothamSemibold
            Label.Text = text
            Label.TextColor3 = Library.Theme.Text
            Label.TextSize = 13
            Label.TextXAlignment = Enum.TextXAlignment.Left
            
            local ValueLabel = Instance.new("TextLabel")
            ValueLabel.Parent = SliderFrame
            ValueLabel.BackgroundTransparency = 1
            ValueLabel.Position = UDim2.new(0, 12, 0, 8)
            ValueLabel.Size = UDim2.new(1, -24, 0, 20)
            ValueLabel.Font = Enum.Font.Gotham
            ValueLabel.Text = tostring(default)
            ValueLabel.TextColor3 = Library.Theme.TextDark
            ValueLabel.TextSize = 12
            ValueLabel.TextXAlignment = Enum.TextXAlignment.Right
            
            local BarBG = Instance.new("Frame")
            BarBG.Parent = SliderFrame
            BarBG.BackgroundColor3 = Library.Theme.Main
            BarBG.Position = UDim2.new(0, 12, 0, 34)
            BarBG.Size = UDim2.new(1, -24, 0, 6)
            
            local BarCorner = Instance.new("UICorner")
            BarCorner.CornerRadius = UDim.new(1, 0)
            BarCorner.Parent = BarBG
            
            local Fill = Instance.new("Frame")
            Fill.Parent = BarBG
            Fill.BackgroundColor3 = Library.Theme.Accent
            Fill.Size = UDim2.new((default - min) / (max - min), 0, 1, 0)
            
            local FillCorner = Instance.new("UICorner")
            FillCorner.CornerRadius = UDim.new(1, 0)
            FillCorner.Parent = Fill
            
            local Trigger = Instance.new("TextButton")
            Trigger.Parent = BarBG
            Trigger.BackgroundTransparency = 1
            Trigger.Size = UDim2.new(1, 0, 1, 0)
            Trigger.Text = ""
            
            local dragging = false
            
            local function UpdateSlide(input)
                local pos = math.clamp((input.Position.X - BarBG.AbsolutePosition.X) / BarBG.AbsoluteSize.X, 0, 1)
                local value = math.floor(((pos * (max - min)) + min) * 10) / 10
                
                Tween(Fill, {Time=0.1}, {Size = UDim2.new(pos, 0, 1, 0)})
                ValueLabel.Text = tostring(value)
                callback(value)
            end
            
            Trigger.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    dragging = true
                    UpdateSlide(input)
                end
            end)
            
            UserInputService.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end
            end)
            
            UserInputService.InputChanged:Connect(function(input)
                if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                    UpdateSlide(input)
                end
            end)
        end

        --// ELEMENT: DROPDOWN
        function TabFunctions:Dropdown(text, list, callback)
            local Dropdown = Instance.new("Frame")
            Dropdown.Name = "Dropdown"
            Dropdown.Parent = Page
            Dropdown.BackgroundColor3 = Library.Theme.Secondary
            Dropdown.Size = UDim2.new(1, 0, 0, 38)
            Dropdown.ClipsDescendants = true
            
            local DropCorner = Instance.new("UICorner")
            DropCorner.CornerRadius = UDim.new(0, 6)
            DropCorner.Parent = Dropdown
            
            local DropStroke = Instance.new("UIStroke")
            DropStroke.Parent = Dropdown
            DropStroke.Color = Library.Theme.Stroke
            DropStroke.Thickness = 1
            
            local DropBtn = Instance.new("TextButton")
            DropBtn.Parent = Dropdown
            DropBtn.BackgroundTransparency = 1
            DropBtn.Size = UDim2.new(1, 0, 0, 38)
            DropBtn.Font = Enum.Font.GothamSemibold
            DropBtn.Text = "  " .. text
            DropBtn.TextColor3 = Library.Theme.Text
            DropBtn.TextSize = 13
            DropBtn.TextXAlignment = Enum.TextXAlignment.Left
            
            local Arrow = Instance.new("ImageLabel")
            Arrow.Parent = DropBtn
            Arrow.AnchorPoint = Vector2.new(1, 0.5)
            Arrow.BackgroundTransparency = 1
            Arrow.Position = UDim2.new(1, -10, 0.5, 0)
            Arrow.Size = UDim2.new(0, 20, 0, 20)
            Arrow.Image = "rbxassetid://6034818372" -- Down arrow
            Arrow.ImageColor3 = Library.Theme.TextDark
            
            local List = Instance.new("ScrollingFrame")
            List.Parent = Dropdown
            List.BackgroundTransparency = 1
            List.Position = UDim2.new(0, 0, 0, 40)
            List.Size = UDim2.new(1, 0, 1, -45)
            List.CanvasSize = UDim2.new(0, 0, 0, 0)
            List.ScrollBarThickness = 2
            
            local ListLayout = Instance.new("UIListLayout")
            ListLayout.Parent = List
            ListLayout.Padding = UDim.new(0, 2)
            
            local open = false
            
            local function RefreshList()
                for _, v in pairs(List:GetChildren()) do if v:IsA("TextButton") then v:Destroy() end end
                
                for _, item in pairs(list) do
                    local ItemBtn = Instance.new("TextButton")
                    ItemBtn.Parent = List
                    ItemBtn.BackgroundColor3 = Library.Theme.Main
                    ItemBtn.Size = UDim2.new(1, -10, 0, 26)
                    ItemBtn.Position = UDim2.new(0, 5, 0, 0)
                    ItemBtn.Font = Enum.Font.Gotham
                    ItemBtn.Text = item
                    ItemBtn.TextColor3 = Library.Theme.TextDark
                    ItemBtn.TextSize = 12
                    
                    local IC = Instance.new("UICorner")
                    IC.CornerRadius = UDim.new(0, 4)
                    IC.Parent = ItemBtn
                    
                    ItemBtn.MouseButton1Click:Connect(function()
                        DropBtn.Text = "  " .. text .. ": " .. item
                        callback(item)
                        open = false
                        Tween(Dropdown, {Time=0.3}, {Size = UDim2.new(1, 0, 0, 38)})
                        Tween(Arrow, {Time=0.3}, {Rotation = 0})
                    end)
                end
                List.CanvasSize = UDim2.new(0, 0, 0, ListLayout.AbsoluteContentSize.Y + 10)
            end
            RefreshList()
            
            DropBtn.MouseButton1Click:Connect(function()
                open = not open
                local height = 38
                if open then
                    height = 38 + math.min(#list, 4) * 30 + 10
                    Tween(Arrow, {Time=0.3}, {Rotation = 180})
                else
                    Tween(Arrow, {Time=0.3}, {Rotation = 0})
                end
                Tween(Dropdown, {Time=0.3}, {Size = UDim2.new(1, 0, 0, height)})
            end)
        end

        --// ELEMENT: TEXTBOX
        function TabFunctions:TextBox(text, placeholder, callback)
            local Frame = Instance.new("Frame")
            Frame.Name = "TextBox"
            Frame.Parent = Page
            Frame.BackgroundColor3 = Library.Theme.Secondary
            Frame.Size = UDim2.new(1, 0, 0, 38)
            
            local Corner = Instance.new("UICorner")
            Corner.CornerRadius = UDim.new(0, 6)
            Corner.Parent = Frame
            
            local Stroke = Instance.new("UIStroke")
            Stroke.Parent = Frame
            Stroke.Color = Library.Theme.Stroke
            Stroke.Thickness = 1
            
            local Label = Instance.new("TextLabel")
            Label.Parent = Frame
            Label.BackgroundTransparency = 1
            Label.Position = UDim2.new(0, 12, 0, 0)
            Label.Size = UDim2.new(0.4, 0, 1, 0)
            Label.Font = Enum.Font.GothamSemibold
            Label.Text = text
            Label.TextColor3 = Library.Theme.Text
            Label.TextSize = 13
            Label.TextXAlignment = Enum.TextXAlignment.Left
            
            local InputBox = Instance.new("TextBox")
            InputBox.Parent = Frame
            InputBox.BackgroundColor3 = Library.Theme.Main
            InputBox.Position = UDim2.new(0.5, 0, 0.15, 0)
            InputBox.Size = UDim2.new(0.45, 0, 0.7, 0)
            InputBox.Font = Enum.Font.Gotham
            InputBox.PlaceholderText = placeholder
            InputBox.Text = ""
            InputBox.TextColor3 = Library.Theme.Text
            InputBox.TextSize = 12
            
            local BoxCorner = Instance.new("UICorner")
            BoxCorner.CornerRadius = UDim.new(0, 4)
            BoxCorner.Parent = InputBox
            
            InputBox.FocusLost:Connect(function()
                callback(InputBox.Text)
                Tween(Stroke, {Time=0.2}, {Color = Library.Theme.Stroke})
            end)
            
            InputBox.Focused:Connect(function()
                Tween(Stroke, {Time=0.2}, {Color = Library.Theme.Accent})
            end)
        end
        
        --// ELEMENT: COLOR PICKER (Advanced)
        function TabFunctions:ColorPicker(text, default, callback)
            local ColorFrame = Instance.new("Frame")
            ColorFrame.Name = "ColorPicker"
            ColorFrame.Parent = Page
            ColorFrame.BackgroundColor3 = Library.Theme.Secondary
            ColorFrame.Size = UDim2.new(1, 0, 0, 38)
            ColorFrame.ClipsDescendants = true
            
            local CFCorner = Instance.new("UICorner"); CFCorner.CornerRadius = UDim.new(0,6); CFCorner.Parent = ColorFrame
            local CFStroke = Instance.new("UIStroke"); CFStroke.Parent = ColorFrame; CFStroke.Color = Library.Theme.Stroke
            
            local Label = Instance.new("TextLabel")
            Label.Parent = ColorFrame
            Label.BackgroundTransparency = 1
            Label.Position = UDim2.new(0, 12, 0, 0)
            Label.Size = UDim2.new(0.5, 0, 0, 38)
            Label.Font = Enum.Font.GothamSemibold
            Label.Text = text
            Label.TextColor3 = Library.Theme.Text
            Label.TextSize = 13
            Label.TextXAlignment = Enum.TextXAlignment.Left
            
            local ColorPreview = Instance.new("TextButton")
            ColorPreview.Parent = ColorFrame
            ColorPreview.Position = UDim2.new(1, -50, 0.5, -10)
            ColorPreview.Size = UDim2.new(0, 40, 0, 20)
            ColorPreview.BackgroundColor3 = default or Color3.fromRGB(255, 255, 255)
            ColorPreview.Text = ""
            Instance.new("UICorner", ColorPreview).CornerRadius = UDim.new(0, 4)
            
            -- Picker Logic
            local PickerOpen = false
            local Container = Instance.new("Frame")
            Container.Parent = ColorFrame
            Container.BackgroundColor3 = Library.Theme.Main
            Container.Position = UDim2.new(0, 0, 0, 40)
            Container.Size = UDim2.new(1, 0, 0, 110)
            Container.BackgroundTransparency = 1
            
            local RGB = Instance.new("ImageLabel")
            RGB.Parent = Container
            RGB.Image = "rbxassetid://4155801252" -- Rainbow
            RGB.Position = UDim2.new(0, 10, 0, 10)
            RGB.Size = UDim2.new(1, -20, 0, 80)
            Instance.new("UICorner", RGB).CornerRadius = UDim.new(0,4)
            
            local Marker = Instance.new("Frame")
            Marker.Parent = RGB
            Marker.BackgroundColor3 = Color3.fromRGB(255,255,255)
            Marker.Size = UDim2.new(0, 2, 1, 0)
            Marker.ZIndex = 2
            
            local function UpdateColor(input)
                 local pos = math.clamp((input.Position.X - RGB.AbsolutePosition.X) / RGB.AbsoluteSize.X, 0, 1)
                 Marker.Position = UDim2.new(pos, 0, 0, 0)
                 local color = Color3.fromHSV(pos, 1, 1) -- Simplified HSV
                 ColorPreview.BackgroundColor3 = color
                 callback(color)
            end
            
            local dragging = false
            RGB.InputBegan:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 then dragging = true UpdateColor(i) end end)
            UserInputService.InputEnded:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end end)
            UserInputService.InputChanged:Connect(function(i) if dragging and i.UserInputType == Enum.UserInputType.MouseMovement then UpdateColor(i) end end)
            
            ColorPreview.MouseButton1Click:Connect(function()
                PickerOpen = not PickerOpen
                Tween(ColorFrame, {Time=0.3}, {Size = PickerOpen and UDim2.new(1,0,0,150) or UDim2.new(1,0,0,38)})
            end)
        end
        
        --// ELEMENT: KEYBIND
        function TabFunctions:Keybind(text, default, callback)
            local key = default or Enum.KeyCode.E
            local BindFrame = Instance.new("Frame")
            BindFrame.Name = "Keybind"
            BindFrame.Parent = Page
            BindFrame.BackgroundColor3 = Library.Theme.Secondary
            BindFrame.Size = UDim2.new(1, 0, 0, 38)
            
            Instance.new("UICorner", BindFrame).CornerRadius = UDim.new(0, 6)
            local Stroke = Instance.new("UIStroke"); Stroke.Parent = BindFrame; Stroke.Color = Library.Theme.Stroke
            
            local Label = Instance.new("TextLabel")
            Label.Parent = BindFrame
            Label.BackgroundTransparency = 1
            Label.Position = UDim2.new(0, 12, 0, 0)
            Label.Size = UDim2.new(0.6, 0, 1, 0)
            Label.Font = Enum.Font.GothamSemibold
            Label.Text = text
            Label.TextColor3 = Library.Theme.Text
            Label.TextSize = 13
            Label.TextXAlignment = Enum.TextXAlignment.Left
            
            local BindBtn = Instance.new("TextButton")
            BindBtn.Parent = BindFrame
            BindBtn.BackgroundColor3 = Library.Theme.Main
            BindBtn.Position = UDim2.new(1, -90, 0.5, -12)
            BindBtn.Size = UDim2.new(0, 80, 0, 24)
            BindBtn.Font = Enum.Font.Gotham
            BindBtn.Text = "[" .. key.Name .. "]"
            BindBtn.TextColor3 = Library.Theme.TextDark
            BindBtn.TextSize = 12
            Instance.new("UICorner", BindBtn).CornerRadius = UDim.new(0,4)
            
            local listening = false
            
            BindBtn.MouseButton1Click:Connect(function()
                listening = true
                BindBtn.Text = "..."
                BindBtn.TextColor3 = Library.Theme.Accent
            end)
            
            UserInputService.InputBegan:Connect(function(input)
                if listening and input.UserInputType == Enum.UserInputType.Keyboard then
                    key = input.KeyCode
                    BindBtn.Text = "[" .. key.Name .. "]"
                    BindBtn.TextColor3 = Library.Theme.TextDark
                    listening = false
                    callback(key)
                elseif not listening and input.KeyCode == key then
                    callback(key)
                end
            end)
        end

        return TabFunctions
    end
    
    return WindowFunctions
end

return Library
